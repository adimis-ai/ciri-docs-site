"use strict";(self.webpackChunkciri_docs=self.webpackChunkciri_docs||[]).push([[7339],{2040(e,n,r){r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"features/script-executor","title":"Script Executor","description":"The execute_script tool gives Ciri the ability to run arbitrary Python or JavaScript code in a fully isolated, sandboxed environment \u2014 with your explicit approval before anything runs. It handles dependency installation, execution, output collection, and cleanup automatically.","source":"@site/docs/features/script-executor.md","sourceDirName":"features","slug":"/features/script-executor","permalink":"/docs/features/script-executor","draft":false,"unlisted":false,"editUrl":"https://github.com/adimis-ai/ciri/tree/main/docs-site/docs/features/script-executor.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Deep Web Research","permalink":"/docs/features/web-research"},"next":{"title":"Built-in Skills","permalink":"/docs/built-in-skills/"}}');var i=r(4848),s=r(8453);const c={},o="Script Executor",d={},l=[{value:"What It Does",id:"what-it-does",level:2},{value:"When Ciri Uses It",id:"when-ciri-uses-it",level:2},{value:"The Approval Prompt",id:"the-approval-prompt",level:2},{value:"Input Parameters",id:"input-parameters",level:2},{value:"Isolation Model",id:"isolation-model",level:2},{value:"Output Preservation",id:"output-preservation",level:2},{value:"Playwright Special Handling",id:"playwright-special-handling",level:2},{value:"Output Streaming",id:"output-streaming",level:2},{value:"Security Boundaries",id:"security-boundaries",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"script-executor",children:"Script Executor"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"execute_script"})," tool gives Ciri the ability to run arbitrary Python or JavaScript code in a ",(0,i.jsx)(n.strong,{children:"fully isolated, sandboxed environment"})," \u2014 with your explicit approval before anything runs. It handles dependency installation, execution, output collection, and cleanup automatically."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"what-it-does",children:"What It Does"}),"\n",(0,i.jsx)(n.mermaid,{value:"flowchart LR\n  Ciri[Ciri proposes\\na script] --\x3e HITL[HITL interrupt:\\nyou review & approve]\n  HITL --\x3e Env[Create isolated\\nvenv or node_modules]\n  Env --\x3e Deps[Install\\ndependencies]\n  Deps --\x3e Run[Execute script\\nwith streaming output]\n  Run --\x3e Out[Collect outputs\\nto output_dir]\n  Out --\x3e Clean[Cleanup temp env\\nif cleanup=true]\n  Clean --\x3e Return[Return result\\nto Ciri]"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"when-ciri-uses-it",children:"When Ciri Uses It"}),"\n",(0,i.jsxs)(n.p,{children:["Ciri reaches for ",(0,i.jsx)(n.code,{children:"execute_script"})," when a task requires:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Python data processing"})," \u2014 pandas, numpy, scipy, matplotlib"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Browser automation"})," \u2014 Playwright, Selenium (auto-installs Playwright chromium if needed)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"File generation"})," \u2014 producing CSVs, Excel files, images, PDFs as output"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Package-specific operations"})," \u2014 anything requiring a library not already installed"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Isolated computation"})," \u2014 avoiding side effects on the host environment"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"the-approval-prompt",children:"The Approval Prompt"}),"\n",(0,i.jsx)(n.p,{children:"Before anything runs, you see a Rich-rendered approval panel:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551  \ud83d\udcdc Script Execution Approval                                 \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551  Language: python        Timeout: 120s   Cleanup: yes        \u2551\n\u2551  Dependencies: pandas, openpyxl                               \u2551\n\u2551  Working dir: /home/user/projects/my-startup                  \u2551\n\u2551  Output dir:  /home/user/projects/my-startup/output           \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551  import pandas as pd                                          \u2551\n\u2551  import openpyxl                                              \u2551\n\u2551                                                               \u2551\n\u2551  df = pd.read_excel("data/q1_sales.xlsx")                    \u2551\n\u2551  summary = df.groupby("region")["revenue"].sum()              \u2551\n\u2551  summary.to_csv("output/revenue_by_region.csv")              \u2551\n\u2551  print(summary.to_string())                                   \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551  [1] Approve    [2] Reject                                    \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You see the ",(0,i.jsx)(n.strong,{children:"full script"}),", dependencies, working directory, and where outputs will be saved \u2014 before a single line of code runs."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"input-parameters",children:"Input Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"script_content"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"required"}),(0,i.jsx)(n.td,{children:"Full source code of the script"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"language"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'"python"'})," or ",(0,i.jsx)(n.code,{children:'"javascript"'})]}),(0,i.jsx)(n.td,{children:"required"}),(0,i.jsx)(n.td,{children:"Execution runtime"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dependencies"})}),(0,i.jsx)(n.td,{children:"list[string]"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"[]"})}),(0,i.jsx)(n.td,{children:"pip or npm packages to install"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"working_dir"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"current dir"}),(0,i.jsx)(n.td,{children:"Where the script runs"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"output_dir"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"None"})}),(0,i.jsx)(n.td,{children:"Directory for persistent outputs"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"timeout"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"120"})}),(0,i.jsx)(n.td,{children:"Max execution time in seconds"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cleanup"})}),(0,i.jsx)(n.td,{children:"bool"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"True"})}),(0,i.jsx)(n.td,{children:"Delete temp venv/node_modules after run"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"isolation-model",children:"Isolation Model"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Python scripts"})," run in a fresh temporary venv created for each execution:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python -m venv /tmp/ciri-script-XXXXX\n/tmp/ciri-script-XXXXX/bin/pip install <dependencies>\n/tmp/ciri-script-XXXXX/bin/python script.py\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"JavaScript scripts"})," run in a temporary ",(0,i.jsx)(n.code,{children:"node_modules"})," environment:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm init -y\nnpm install <dependencies>\nnode script.js\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When ",(0,i.jsx)(n.code,{children:"cleanup=True"})," (default), the temp environment is deleted after execution. When ",(0,i.jsx)(n.code,{children:"cleanup=False"}),", the environment is preserved for debugging."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"output-preservation",children:"Output Preservation"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"output_dir"})," is specified, any files written there during execution are ",(0,i.jsx)(n.strong,{children:"preserved after cleanup"}),". This is how Ciri delivers generated artifacts (CSV exports, charts, processed documents) to your workspace."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Ciri generates a report \u2192 writes to /tmp/ciri-XXXXX/output/ \u2192\ncopies to output_dir \u2192 deletes /tmp/ciri-XXXXX \u2192\noutput_dir remains with your files\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"playwright-special-handling",children:"Playwright Special Handling"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"playwright"})," is in the ",(0,i.jsx)(n.code,{children:"dependencies"})," list, the script executor automatically runs ",(0,i.jsx)(n.code,{children:"playwright install chromium"})," after installing the package \u2014 ensuring browser automation works in the isolated environment without manual intervention."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"output-streaming",children:"Output Streaming"}),"\n",(0,i.jsx)(n.p,{children:"Script output (stdout and stderr) streams line-by-line back to the terminal in real time, so you can monitor long-running scripts:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Ciri > Running script...\n  [stdout] Processing 10,000 rows...\n  [stdout] Region analysis complete\n  [stdout] Writing output/revenue_by_region.csv\n  [stdout] Done in 3.2s\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"security-boundaries",children:"Security Boundaries"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The script runs as your user \u2014 same permissions as the terminal"}),"\n",(0,i.jsxs)(n.li,{children:["The working directory is scoped to ",(0,i.jsx)(n.code,{children:"working_dir"})," (defaults to your workspace root)"]}),"\n",(0,i.jsx)(n.li,{children:"Network access is unrestricted (scripts can make HTTP requests)"}),"\n",(0,i.jsx)(n.li,{children:"File access is unrestricted within the working directory"}),"\n",(0,i.jsxs)(n.li,{children:["The sandboxing is isolation via venv \u2014 ",(0,i.jsx)(n.strong,{children:"not"})," a kernel-level container"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The Human-in-the-Loop approval is the primary safety gate: ",(0,i.jsx)(n.strong,{children:"review the script carefully before approving"}),", particularly if it performs network requests or file writes outside the output directory."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,r){r.d(n,{R:()=>c,x:()=>o});var t=r(6540);const i={},s=t.createContext(i);function c(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);