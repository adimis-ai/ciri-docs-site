"use strict";(self.webpackChunkciri_docs=self.webpackChunkciri_docs||[]).push([[672],{4480(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"internals/self-evolution","title":"Self-Evolution & Training","description":"Ciri is designed to become a better version of herself over time \u2014 specialized for your exact workspace rather than remaining a generic assistant. The /sync command triggers the Trainer Agent, which orchestrates a structured AUDIT \u2192 ANALYZE \u2192 PLAN \u2192 BUILD \u2192 VERIFY loop.","source":"@site/docs/internals/self-evolution.md","sourceDirName":"internals","slug":"/internals/self-evolution","permalink":"/docs/internals/self-evolution","draft":false,"unlisted":false,"editUrl":"https://github.com/adimis-ai/ciri/tree/main/docs-site/docs/internals/self-evolution.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Middleware Stack","permalink":"/docs/internals/middlewares"},"next":{"title":"Graph Execution & Agent Boot","permalink":"/docs/internals/graph-execution"}}');var s=r(4848),t=r(8453);const l={},d="Self-Evolution & Training",c={},o=[{value:"Overview",id:"overview",level:2},{value:"The Five Phases",id:"the-five-phases",level:2},{value:"1. AUDIT",id:"1-audit",level:3},{value:"2. ANALYZE",id:"2-analyze",level:3},{value:"3. PLAN",id:"3-plan",level:3},{value:"4. BUILD",id:"4-build",level:3},{value:"5. VERIFY",id:"5-verify",level:3},{value:"What Gets Written Where",id:"what-gets-written-where",level:2},{value:"Hot-Reload After Sync",id:"hot-reload-after-sync",level:2},{value:"Ciri Self-Updates Between Syncs",id:"ciri-self-updates-between-syncs",level:2},{value:"Customizing Builder Behavior",id:"customizing-builder-behavior",level:2},{value:"Running Sync Manually vs Automatically",id:"running-sync-manually-vs-automatically",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"self-evolution--training",children:"Self-Evolution & Training"})}),"\n",(0,s.jsxs)(n.p,{children:["Ciri is designed to become a better version of herself over time \u2014 specialized for your exact workspace rather than remaining a generic assistant. The ",(0,s.jsx)(n.code,{children:"/sync"})," command triggers the ",(0,s.jsx)(n.strong,{children:"Trainer Agent"}),", which orchestrates a structured AUDIT \u2192 ANALYZE \u2192 PLAN \u2192 BUILD \u2192 VERIFY loop."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["When you run ",(0,s.jsx)(n.code,{children:"/sync"}),":"]}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n  autonumber\n  participant You as You\n  participant Ciri as Ciri (Main)\n  participant TA as Trainer Agent\n  participant SB as skill_builder\n  participant TB as toolkit_builder\n  participant AB as subagent_builder\n  participant FS as Filesystem\n\n  You->>Ciri: /sync\n  Ciri->>TA: delegate workspace sync\n  TA->>FS: AUDIT \u2014 scan workspace, existing skills, memory files\n  TA->>TA: ANALYZE \u2014 identify gaps, opportunities, outdated knowledge\n  TA->>TA: PLAN \u2014 decide what to create/update\n  TA->>SB: build new skill (if needed)\n  SB->>FS: write skill to core/project harness\n  TA->>TB: build new toolkit (if needed)\n  TB->>FS: write toolkit to core/project harness\n  TA->>AB: define new subagent (if needed)\n  AB->>FS: write subagent config\n  TA->>FS: VERIFY \u2014 confirm all new assets are valid\n  TA->>FS: update .ciri/memory/*.md files\n  TA--\x3e>Ciri: sync complete\n  Ciri--\x3e>You: \u2713 Workspace sync complete"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"the-five-phases",children:"The Five Phases"}),"\n",(0,s.jsx)(n.h3,{id:"1-audit",children:"1. AUDIT"}),"\n",(0,s.jsxs)(n.p,{children:["The Trainer Agent uses ",(0,s.jsx)(n.code,{children:"list_dir"}),", ",(0,s.jsx)(n.code,{children:"read_file"}),", and ",(0,s.jsx)(n.code,{children:"execute"})," to survey:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Project root"})," \u2014 directory structure, file types, technology stack markers (",(0,s.jsx)(n.code,{children:"pyproject.toml"}),", ",(0,s.jsx)(n.code,{children:"package.json"}),", ",(0,s.jsx)(n.code,{children:"Cargo.toml"}),", etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Existing memory"})," \u2014 reads ",(0,s.jsx)(n.code,{children:"~/.local/share/ciri/memory/"})," and ",(0,s.jsx)(n.code,{children:".ciri/memory/"})," to understand what's already known"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Existing skills"})," \u2014 reads ",(0,s.jsx)(n.code,{children:"SKILL.md"})," from both harness levels to catalog active capabilities"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Existing toolkits"})," \u2014 checks toolkit manifests in both harnesses"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recent interaction history"})," \u2014 reviews any notes Ciri has made about limitations or recurring patterns"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-analyze",children:"2. ANALYZE"}),"\n",(0,s.jsx)(n.p,{children:"Based on the audit, the Trainer Agent identifies:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Knowledge gaps"})," \u2014 things the workspace does that Ciri doesn't know about yet"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Capability gaps"})," \u2014 tasks that Ciri has been asked to do but lacks a dedicated skill or toolkit for"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Stale memory"})," \u2014 memory files that reference old module names, deprecated patterns, or outdated conventions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"New skill opportunities"})," \u2014 recurring workflows that would benefit from a dedicated playbook"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-plan",children:"3. PLAN"}),"\n",(0,s.jsx)(n.p,{children:"The Trainer Agent produces a structured plan:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Plan:\n1. Update .ciri/memory/architecture.md \u2014 auth module was renamed from `auth/` to `authentication/`\n2. Create skill: salesforce-pipeline \u2014 user asked for this 3x in recent threads\n3. Create toolkit: internal-metrics \u2014 needs API connection to metrics.internal\n4. Create memory file: .ciri/memory/domain.md \u2014 workspace is a B2B legal SaaS, no domain file yet\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-build",children:"4. BUILD"}),"\n",(0,s.jsx)(n.p,{children:"For each planned item, the Trainer Agent delegates to the appropriate builder:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Builder"}),(0,s.jsx)(n.th,{children:"Creates"}),(0,s.jsx)(n.th,{children:"Location"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"skill_builder"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"SKILL.md"})," + supporting files"]}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"~/.local/share/ciri/skills/<name>/"})," or ",(0,s.jsx)(n.code,{children:".ciri/skills/<name>/"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"toolkit_builder"})}),(0,s.jsx)(n.td,{children:"MCP server manifest + runner"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"~/.local/share/ciri/toolkits/<name>/"})," or ",(0,s.jsx)(n.code,{children:".ciri/toolkits/<name>/"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"subagent_builder"})}),(0,s.jsx)(n.td,{children:"YAML subagent config"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"~/.local/share/ciri/subagents/<name>.yaml"})," or ",(0,s.jsx)(n.code,{children:".ciri/subagents/"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Trainer Agent directly"}),(0,s.jsxs)(n.td,{children:["Memory ",(0,s.jsx)(n.code,{children:".md"})," files"]}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"~/.local/share/ciri/memory/"})," or ",(0,s.jsx)(n.code,{children:".ciri/memory/"})]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["By default, new assets go to the ",(0,s.jsx)(n.strong,{children:"core harness"})," (",(0,s.jsx)(n.code,{children:"~/.local/share/ciri/"}),") so they're available across all projects. If the asset is project-specific, it goes to ",(0,s.jsx)(n.code,{children:".ciri/"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"5-verify",children:"5. VERIFY"}),"\n",(0,s.jsx)(n.p,{children:"After building, the Trainer Agent:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Re-reads each new file to confirm it was written correctly"}),"\n",(0,s.jsxs)(n.li,{children:["Validates YAML frontmatter in ",(0,s.jsx)(n.code,{children:"SKILL.md"})," files"]}),"\n",(0,s.jsx)(n.li,{children:"Confirms toolkit manifests reference valid entry points"}),"\n",(0,s.jsxs)(n.li,{children:["Updates ",(0,s.jsx)(n.code,{children:".ciri/memory/AGENT.md"})," to index any new capabilities"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"what-gets-written-where",children:"What Gets Written Where"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Core harness (~/.local/share/ciri/)     \u2190 cross-project, permanent\n\u251c\u2500\u2500 skills/\n\u2502   \u2514\u2500\u2500 <new-skill>/SKILL.md\n\u251c\u2500\u2500 toolkits/\n\u2502   \u2514\u2500\u2500 <new-toolkit>/manifest.json\n\u251c\u2500\u2500 subagents/\n\u2502   \u2514\u2500\u2500 <new-subagent>.yaml\n\u2514\u2500\u2500 memory/\n    \u2514\u2500\u2500 global-preferences.md\n\nProject harness (.ciri/)                \u2190 this workspace only\n\u2514\u2500\u2500 memory/\n    \u251c\u2500\u2500 AGENT.md                \u2190 updated by Trainer Agent\n    \u251c\u2500\u2500 architecture.md         \u2190 updated after refactors\n    \u251c\u2500\u2500 conventions.md\n    \u251c\u2500\u2500 domain.md               \u2190 business context\n    \u2514\u2500\u2500 workflows.md\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"hot-reload-after-sync",children:"Hot-Reload After Sync"}),"\n",(0,s.jsxs)(n.p,{children:["After ",(0,s.jsx)(n.code,{children:"/sync"})," completes, Ciri's middleware stack automatically picks up new assets:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Skills"})," \u2014 ",(0,s.jsx)(n.code,{children:"SkillsMiddleware._refresh_sources()"})," re-scans both harness levels"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Toolkits"})," \u2014 ",(0,s.jsx)(n.code,{children:"ToolkitInjectionMiddleware"})," discovers and connects to new MCP servers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Subagents"})," \u2014 ",(0,s.jsx)(n.code,{children:"SubAgentMiddleware"})," reloads the subagent registry"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Memory"})," \u2014 ",(0,s.jsx)(n.code,{children:"MemoryMiddleware"})," re-reads all ",(0,s.jsx)(n.code,{children:".md"})," files on the next turn"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"No restart required."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"ciri-self-updates-between-syncs",children:"Ciri Self-Updates Between Syncs"}),"\n",(0,s.jsx)(n.p,{children:"The Trainer Agent isn't the only source of memory updates. Ciri is instructed to update memory files autonomously after significant work:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Ciri > I've refactored the authentication module. Updating .ciri/memory/architecture.md\n       with the new session management approach and module rename.\n"})}),"\n",(0,s.jsx)(n.p,{children:"This happens after:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Large refactors or architectural changes"}),"\n",(0,s.jsx)(n.li,{children:"New features that affect conventions"}),"\n",(0,s.jsx)(n.li,{children:"Discovery of important domain concepts during research"}),"\n",(0,s.jsx)(n.li,{children:"Completion of complex multi-step tasks"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"customizing-builder-behavior",children:"Customizing Builder Behavior"}),"\n",(0,s.jsx)(n.p,{children:"The five built-in subagents each have a configurable system prompt:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Builder"}),(0,s.jsx)(n.th,{children:"Source"}),(0,s.jsx)(n.th,{children:"What to Customize"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"trainer_agent"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"src/subagents/trainer_agent.py"})}),(0,s.jsx)(n.td,{children:"Audit scope, memory file structure, plan format"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"skill_builder"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"src/subagents/skill_builder.py"})}),(0,s.jsx)(n.td,{children:"Skill directory structure, playbook format, license"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"toolkit_builder"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"src/subagents/toolkit_builder.py"})}),(0,s.jsx)(n.td,{children:"Preferred language (Python vs Node.js), auth patterns"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"subagent_builder"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"src/subagents/subagent_builder.py"})}),(0,s.jsx)(n.td,{children:"YAML schema, tool selection logic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"web_researcher"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"src/subagents/web_researcher.py"})}),(0,s.jsx)(n.td,{children:"Source preferences, output format, depth"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["To override a builder's behavior for your workspace, create a YAML subagent config in ",(0,s.jsx)(n.code,{children:".ciri/subagents/skill_builder.yaml"})," \u2014 the SubAgent deduplication (by file stem) ensures your project version takes precedence over the core harness version."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"running-sync-manually-vs-automatically",children:"Running Sync Manually vs Automatically"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["When to run ",(0,s.jsx)(n.code,{children:"/sync"}),":"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"First time you start Ciri in a new project"}),"\n",(0,s.jsx)(n.li,{children:"After major refactors or architectural changes"}),"\n",(0,s.jsx)(n.li,{children:"After a rebrand (new domain vocabulary, conventions)"}),"\n",(0,s.jsx)(n.li,{children:"When you want Ciri to build a new skill or toolkit based on patterns she's observed"}),"\n",(0,s.jsx)(n.li,{children:"After onboarding new team members who add new patterns to the codebase"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Automatic triggers"})," (planned \u2014 see ",(0,s.jsx)(n.a,{href:"/docs/roadmap",children:"Roadmap"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Webhook-triggered sync on Git push"}),"\n",(0,s.jsx)(n.li,{children:"Periodic background sync (configurable interval)"}),"\n",(0,s.jsx)(n.li,{children:"Sync on context-window approach (SummarizationMiddleware integration)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453(e,n,r){r.d(n,{R:()=>l,x:()=>d});var i=r(6540);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);