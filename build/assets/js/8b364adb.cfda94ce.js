"use strict";(self.webpackChunkciri_docs=self.webpackChunkciri_docs||[]).push([[4857],{9240(e,s,i){i.r(s),i.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"toolkits-guide","title":"Toolkits Guide (MCP)","description":"Toolkits are MCP (Model Context Protocol) servers that give Ciri live, bidirectional access to external services \u2014 databases, SaaS APIs, cloud platforms, internal tools, and anything else that can be wrapped in an MCP interface. Ciri\'s ToolkitInjectionMiddleware acts as an MCP client that discovers, connects to, and hot-reloads these servers without requiring a restart.","source":"@site/docs/toolkits-guide.md","sourceDirName":".","slug":"/toolkits-guide","permalink":"/docs/toolkits-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/adimis-ai/ciri/tree/main/docs-site/docs/toolkits-guide.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Skills Guide","permalink":"/docs/skills-guide"},"next":{"title":"SubAgents & Delegation","permalink":"/docs/subagents-guide"}}');var n=i(4848),r=i(8453);const o={},l="Toolkits Guide (MCP)",c={},d=[{value:"What Is a Toolkit?",id:"what-is-a-toolkit",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Adding a Toolkit",id:"adding-a-toolkit",level:2},{value:"Via Ciri (recommended)",id:"via-ciri-recommended",level:3},{value:"Via <code>/sync</code>",id:"via-sync",level:3},{value:"Manual addition (community MCP servers)",id:"manual-addition-community-mcp-servers",level:3},{value:"Toolkit Directory Structure",id:"toolkit-directory-structure",level:2},{value:"Toolkit Discovery Order",id:"toolkit-discovery-order",level:2},{value:"Security Practices",id:"security-practices",level:2},{value:"Toolkit vs. Skill vs. SubAgent",id:"toolkit-vs-skill-vs-subagent",level:2},{value:"Hot-Reload",id:"hot-reload",level:2}];function a(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"toolkits-guide-mcp",children:"Toolkits Guide (MCP)"})}),"\n",(0,n.jsxs)(s.p,{children:["Toolkits are ",(0,n.jsx)(s.strong,{children:"MCP (Model Context Protocol) servers"})," that give Ciri live, bidirectional access to external services \u2014 databases, SaaS APIs, cloud platforms, internal tools, and anything else that can be wrapped in an MCP interface. Ciri's ",(0,n.jsx)(s.code,{children:"ToolkitInjectionMiddleware"})," acts as an MCP client that discovers, connects to, and hot-reloads these servers without requiring a restart."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"what-is-a-toolkit",children:"What Is a Toolkit?"}),"\n",(0,n.jsxs)(s.p,{children:["Where a Skill is a playbook (static knowledge), a Toolkit is a ",(0,n.jsx)(s.strong,{children:"live service connection"}),". When Ciri has a Slack toolkit, she can actually send messages, read channels, and search conversations \u2014 not just know how to do it."]}),"\n",(0,n.jsx)(s.p,{children:"Toolkits are standard MCP servers. Anything that speaks MCP can be a Ciri toolkit:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Community MCP servers"})," (Slack, GitHub, Google Drive, Postgres, Jira, etc.)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Custom servers"})," built by Ciri using the ",(0,n.jsx)(s.code,{children:"mcp-builder"})," skill"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Internal systems"})," exposed via a lightweight FastMCP or TypeScript MCP SDK wrapper"]}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"architecture",children:"Architecture"}),"\n",(0,n.jsx)(s.mermaid,{value:"flowchart LR\n  subgraph Ciri\n    MW[ToolkitInjectionMiddleware\\n MCP Client]\n  end\n\n  subgraph Core Harness\n    T1[~/.local/share/ciri/toolkits/slack/]\n    T2[~/.local/share/ciri/toolkits/github/]\n  end\n\n  subgraph Project Harness\n    T3[.ciri/toolkits/my-db/]\n  end\n\n  MW <--\x3e T1\n  MW <--\x3e T2\n  MW <--\x3e T3\n  T1 <--\x3e Slack[Slack API]\n  T2 <--\x3e GitHub[GitHub API]\n  T3 <--\x3e DB[(PostgreSQL)]"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"ToolkitInjectionMiddleware"}),":"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Discovers toolkit directories in the core and project harness"}),"\n",(0,n.jsx)(s.li,{children:"Spawns each MCP server as a subprocess (Python or Node.js)"}),"\n",(0,n.jsx)(s.li,{children:"Registers all server-exposed tools into Ciri's active toolset"}),"\n",(0,n.jsx)(s.li,{children:"Monitors for version changes and restarts servers automatically"}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"adding-a-toolkit",children:"Adding a Toolkit"}),"\n",(0,n.jsx)(s.h3,{id:"via-ciri-recommended",children:"Via Ciri (recommended)"}),"\n",(0,n.jsx)(s.p,{children:"Ask Ciri in natural language:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"You > Build a toolkit to connect to my PostgreSQL database at localhost:5432\nYou > Create a Slack toolkit for our workspace\nYou > Build a toolkit for our internal Jira instance at jira.company.com\nYou > Connect to our GitHub organization repos via toolkit\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Ciri invokes the ",(0,n.jsx)(s.code,{children:"toolkit_builder_agent"}),", which uses the ",(0,n.jsx)(s.code,{children:"mcp-builder"})," skill to:"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"Scaffold the MCP server (Python with FastMCP, or TypeScript with MCP SDK)"}),"\n",(0,n.jsx)(s.li,{children:"Write the tool implementations"}),"\n",(0,n.jsxs)(s.li,{children:["Store the server in ",(0,n.jsx)(s.code,{children:".ciri/toolkits/<name>/"})," or the core harness"]}),"\n",(0,n.jsx)(s.li,{children:"Test the connection"}),"\n",(0,n.jsx)(s.li,{children:"Hot-reload without restart"}),"\n"]}),"\n",(0,n.jsxs)(s.h3,{id:"via-sync",children:["Via ",(0,n.jsx)(s.code,{children:"/sync"})]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"You > /sync \u2014 add toolkits for the services in my stack\n"})}),"\n",(0,n.jsx)(s.p,{children:"The Trainer Agent detects service configurations (database URLs, API keys, etc.) from your workspace and builds appropriate toolkits."}),"\n",(0,n.jsx)(s.h3,{id:"manual-addition-community-mcp-servers",children:"Manual addition (community MCP servers)"}),"\n",(0,n.jsxs)(s.p,{children:["For well-known community MCP servers, add the configuration to ",(0,n.jsx)(s.code,{children:".ciri/settings.json"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'{\n  "toolkits": {\n    "filesystem": {\n      "command": "npx",\n      "args": ["-y", "@modelcontextprotocol/server-filesystem", "/Users/you/Documents"],\n      "transport": "stdio"\n    },\n    "postgres": {\n      "command": "npx",\n      "args": ["-y", "@modelcontextprotocol/server-postgres"],\n      "env": {\n        "POSTGRES_CONNECTION_STRING": "postgresql://user:pass@localhost/mydb"\n      },\n      "transport": "stdio"\n    }\n  }\n}\n'})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"toolkit-directory-structure",children:"Toolkit Directory Structure"}),"\n",(0,n.jsxs)(s.p,{children:["A Ciri-built toolkit lives in a directory with either ",(0,n.jsx)(s.code,{children:"pyproject.toml"})," (Python) or ",(0,n.jsx)(s.code,{children:"package.json"})," (Node.js):"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Python toolkit (FastMCP):"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:".ciri/toolkits/my-toolkit/\n\u251c\u2500\u2500 pyproject.toml     \u2190 Package metadata + dependencies\n\u251c\u2500\u2500 server.py          \u2190 MCP server implementation\n\u2514\u2500\u2500 .env               \u2190 Secrets (never committed)\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Node.js toolkit:"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:".ciri/toolkits/my-toolkit/\n\u251c\u2500\u2500 package.json       \u2190 Package metadata + dependencies\n\u251c\u2500\u2500 index.js           \u2190 MCP server implementation\n\u2514\u2500\u2500 .env               \u2190 Secrets (never committed)\n"})}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"ToolkitInjectionMiddleware"})," auto-installs dependencies via ",(0,n.jsx)(s.code,{children:"uv pip install"})," (Python) or ",(0,n.jsx)(s.code,{children:"npm install"})," (Node.js) on first run."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"toolkit-discovery-order",children:"Toolkit Discovery Order"}),"\n",(0,n.jsxs)(s.p,{children:["Toolkits are discovered using an ordered dictionary \u2014 ",(0,n.jsx)(s.strong,{children:"first-wins"}),":"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Core harness (",(0,n.jsx)(s.code,{children:"~/.local/share/ciri/toolkits/"}),") \u2014 highest priority"]}),"\n",(0,n.jsxs)(s.li,{children:["Project harness (",(0,n.jsx)(s.code,{children:".ciri/toolkits/"}),") \u2014 project-specific"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["If a toolkit with the same name exists in both harness levels, the ",(0,n.jsx)(s.strong,{children:"core harness version is used"}),"."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"security-practices",children:"Security Practices"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Process isolation"}),": Each MCP server runs as a separate subprocess. A crash or misbehavior in a toolkit does not affect Ciri or other toolkits."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Secrets management"}),": Store API keys and credentials in the toolkit's ",(0,n.jsx)(s.code,{children:".env"})," file. Ciri will never hardcode credentials into toolkit source code. Add ",(0,n.jsx)(s.code,{children:".ciri/toolkits/*/"})," to ",(0,n.jsx)(s.code,{children:".gitignore"})," if your toolkit directories contain secrets."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Scoping"}),": Each toolkit only has access to the services it explicitly implements. A Slack toolkit cannot access your database."]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Transport"}),": CIRI uses ",(0,n.jsx)(s.code,{children:"stdio"})," transport by default (subprocess stdin/stdout). SSE transport (HTTP) is supported for remote MCP servers."]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"toolkit-vs-skill-vs-subagent",children:"Toolkit vs. Skill vs. SubAgent"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{}),(0,n.jsx)(s.th,{children:"Toolkit"}),(0,n.jsx)(s.th,{children:"Skill"}),(0,n.jsx)(s.th,{children:"SubAgent"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"What it is"})}),(0,n.jsx)(s.td,{children:"Live MCP server process"}),(0,n.jsx)(s.td,{children:"Static playbook + scripts"}),(0,n.jsx)(s.td,{children:"Specialized agent instance"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"When to use"})}),(0,n.jsx)(s.td,{children:"External API/service calls"}),(0,n.jsx)(s.td,{children:"Domain knowledge + workflows"}),(0,n.jsx)(s.td,{children:"Different reasoning scope"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Created by"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"toolkit_builder_agent"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"skill_builder_agent"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"subagent_builder_agent"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Storage"})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"toolkits/"})," directory"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"skills/"})," directory"]}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.code,{children:"subagents/"})," directory"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Hot-reload"})}),(0,n.jsxs)(s.td,{children:["Yes (on ",(0,n.jsx)(s.code,{children:"/sync"}),")"]}),(0,n.jsxs)(s.td,{children:["Yes (on ",(0,n.jsx)(s.code,{children:"/sync"}),")"]}),(0,n.jsxs)(s.td,{children:["Yes (on ",(0,n.jsx)(s.code,{children:"/sync"}),")"]})]})]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"hot-reload",children:"Hot-Reload"}),"\n",(0,n.jsx)(s.p,{children:"Toolkits are hot-reloaded when:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"/sync"})," is run"]}),"\n",(0,n.jsxs)(s.li,{children:["A toolkit's ",(0,n.jsx)(s.code,{children:"pyproject.toml"})," or ",(0,n.jsx)(s.code,{children:"package.json"})," version changes"]}),"\n",(0,n.jsx)(s.li,{children:"Ciri restarts"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"No manual restart required after adding or updating a toolkit."})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8453(e,s,i){i.d(s,{R:()=>o,x:()=>l});var t=i(6540);const n={},r=t.createContext(n);function o(e){const s=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);